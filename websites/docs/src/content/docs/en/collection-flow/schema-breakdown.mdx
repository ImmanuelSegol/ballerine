---
title: Schema Breakdown
description: About Collection Flow

---

## Schema Breakdown

The Collection Flow schema is a powerful feature designed to facilitate the creation of dynamic, multi-step forms that guide users through a series of pages to collect data. This documentation provides an in-depth look at each property and its purpose within the schema.

### Page Properties

The page properties define the overall structure and behavior of each page in the wizard. Each page is configured with the following properties:

- **type**: `'page'` - This property is always set to `'page'` to indicate that the schema represents a page.
- **name**: A string used to display the page name in the application. This is often linked to localization keys for multilingual support, ensuring that the page name is appropriately translated and presented to users.
- **number**: An integer representing the order of the page in the sequence. Pages are displayed in ascending order based on this number, which allows for an organized and logical progression through the form steps.
- **stateName**: A unique identifier for the page, used to maintain state transitions within xstate, which manages the flow of the wizard. This ensures that the state of the form is correctly tracked and managed as the user navigates between pages.
- **pageValidation**: An array of validation rules applied to the entire page. These rules are used to generate validation errors that are displayed to the user under the relevant fields. Validation ensures that the data collected meets the required criteria before allowing the user to proceed. This helps in maintaining the integrity and accuracy of the collected data.

### Rules

Rules are a crucial part of the schema, used to determine the behavior and validation of various elements within the page. Each rule is defined with the following properties:

- **type**: The name of the rule engine, currently supported values are `json-schema` and `json-logic`.
- **value**: The rule configuration, which is a JSON schema for the `json-schema` engine and a `json-logic` definition for the `json-logic` engine.

Rules are used in three main cases:

1. **Checkers**: These include `requiredOn`, `availableOn`, and `visibleOn`. These checkers evaluate the rules and expect a true/false result to determine if an element is required, enabled, or visible, respectively.
2. **Page Validation**: This applies validation rules to the entire page. In this case, only `json-schema` is supported, and it is used to output validation errors under the relevant fields.
3. **Action Dispatch**: Rules also determine whether page actions should be fired. They evaluate conditions to ensure that actions are only executed when the specified criteria are met.

### Actions

Actions are defined within each page to handle specific tasks related to that page. They include the following properties:

- **type**: The name of the action handler or plugin to be executed. This specifies what kind of action should be performed.
- **params**: An object containing plugin-specific parameters required for the action. These parameters provide the necessary details for the action to be carried out correctly.
- **dispatchOn**: An object defining the conditions under which the action is dispatched. It includes:
  - **uiEvents**: An array of events that trigger the action execution. These events are tied to user interactions with UI elements, such as clicks or form submissions.
  - **rules**: A set of rules that determine whether the action can be performed. For example, rules can check if specific values are present before proceeding, ensuring that the action is only executed when the required conditions are met.

### Element Properties

The elements within each page define the individual components that make up the page. These elements include various input fields, containers, and controls that users interact with. Each element has several properties that determine its behavior and appearance:

- **type**: The type of the element, used to map the element to its corresponding UI component. Examples include `json-form`, `h1`, `input`, etc. This property determines how the element is rendered and interacted with on the page.
- **options**: An object containing element-specific parameters. For instance, for an `h1` element, this might include a `text` property with the value `'Hello world'`. These options customize the appearance and behavior of the element.
- **valueDestination**: A string representing the path where the element's value will be saved. This is applicable to input elements, indicating where in the data model the input value should be stored (e.g., `context.data.firstName`). This property ensures that the collected data is correctly mapped to the underlying data structure.
- **name**: A unique identifier for the element, ensuring that each element can be uniquely referenced within the page.
- **availableOn**: An array of rules that determine if the element is enabled or disabled. These rules are evaluated to control whether the user can interact with the element.
- **visibleOn**: Similar to `availableOn`, but these rules control the visibility of the element. If the rules are not met, the element is hidden from the user.
- **requiredOn**: Rules that conditionally indicate if an input element is required. This helps in dynamically adjusting the form based on user inputs or other conditions.

### Example

Below is an example that demonstrates how these properties might be used in a real-world scenario:

#### validationSchema
```json
{
  "type": "object",
  "properties": {
    "phone": {
      "type": "string",
      "pattern": "^[+]?[0-9]{10,15}$",
      "errorMessage": {
        "pattern": "Phone should be in valid format."
      }
    },
    "dateOfBirth": {
      "type": "string",
      "errorMessage": {
        "type": "Date should be valid."
      }
    },
    "firstName": {
      "type": "string",
      "minLength": 1,
      "errorMessage": {
        "minLength": "Min length 1"
      }
    },
    "lastName": {
      "type": "string",
      "minLength": 1,
      "errorMessage": {
        "minLength": "Min length 1"
      }
    },
    "jobTitle": {
      "type": "string",
      "minLength": 1,
      "errorMessage": {
        "minLength": "Min Length 1"
      }
    }
  },
  "required": [
    "phone",
    "firstName",
    "lastName",
    "jobTitle",
    "dateOfBirth"
  ]
}
```

#### Definition
```json
{
  "type": "page",
  "name": "text.personalDetails",
  "number": 1,
  "stateName": "personal_details",
  "pageValidation": [
    {
      "type": "json-schema",
      "value": "validationSchema"
    }
  ],
  "actions": [
    {
      "type": "definitionPlugin",
      "params": {
        "pluginName": "update_end_user"
      },
      "dispatchOn": {
        "uiEvents": [
          {
            "event": "onClick",
            "uiElementName": "next-page-button"
          }
        ],
        "rules": [
          {
            "type": "json-schema",
            "value": "validationSchema"
          }
        ]
      }
    },
    {
      "type": "definitionEvent",
      "params": {
        "eventName": "NEXT"
      },
      "dispatchOn": {
        "uiEvents": [
          {
            "event": "onClick",
            "uiElementName": "next-page-button"
          }
        ],
        "rules": [
          {
            "type": "json-schema",
            "value": "validationSchema"
          }
        ]
      }
    }
  ],
  "elements": [
    {
      "type": "mainContainer",
      "elements": [
        {
          "type": "container",
          "elements": [
            {
              "type": "h1",
              "options": {
                "text": "Personal Information"
              }
            }
          ]
        },
        {
          "type": "json-form",
          "name": "json-form:personal-information",
          "options": {
            "jsonFormDefinition": {
              "required": [
                "first-name-input",
                "last-name-input",
                "job-title-input",
                "date-of-birth-input",
                "phone-number-input"
              ]
            }
          },
          "availableOn": [
            {
              "type": "json-schema",
              "value": "validationSchema"
            }
          ],
          "elements": [
            {
              "name": "first-name-input",
              "type": "json-form:text",
              "valueDestination": "firstName",
              "options": {
                "label": "text.name",
                "hint": "First Name",
                "jsonFormDefinition": {
                  "type": "string"
                }
              }
            },
            {
              "name": "last-name-input",
              "type": "json-form:text",
              "valueDestination": "lastName",
              "options": {
                "hint": "Last Name",
                "jsonFormDefinition": {
                  "type": "string"
                }
              }
            },
            {
              "name": "job-title-input",
              "type": "json-form:text",
              "valueDestination": "jobTitle",
              "options": {
                "label": "Job Title",
                "hint": "CEO",
                "jsonFormDefinition": {
                  "type": "string"
                }
              }
            },
            {
              "name": "date-of-birth-input",
              "type": "json-form:date",
              "valueDestination": "dateOfBirth",
              "options": {
                "label": "Date of Birth",
                "jsonFormDefinition": {
                  "type": "string"
                },
                "uiSchema": {
                  "ui:field": "DateInput",
                  "ui:label": true
                }
              }
            },
            {
              "name": "phone-number-input",
              "type": "international-phone-number",
              "valueDestination": "phone",
              "options": {
                "label": "Phone Number",
                "jsonFormDefinition": {
                  "type": "string"
                },
                "uiSchema": {
                  "ui:field": "PhoneInput",
                  "ui:label": true
                }
              }
            },
            {
              "name": "authority-checkbox",
              "type": "authority-checkbox",
              "valueDestination": "iHaveSigningAuthority",
              "options": {
                "label": "I confirm...",
                "jsonFormDefinition": {
                  "type": "boolean"
                },
                "uiSchema": {
                  "ui:label": false
                }
              }
            }
          ]
        },
        {
          "name": "controls-container",
          "type": "container",
          "options": {
            "align": "right"
          },
          "elements": [
            {
              "name": "next-page-button",
              "type": "submit-button",
              "options": {
                "text": "Submit"
              },
              "availableOn": [
                {
                  "type": "json-logic",
                  "value": {
                    "type": "json-logic",
                    "value": {
                      "if": [
                        {
                          "===": [
                            {
                              "var": "iHaveSigningAuthority"
                            },
                            true
                          ]
                        },
                        true,
                        false
                      ]
                    }
                  }
                }
              ]
            }
          ]
        }
      ]
    }
  ]
}

